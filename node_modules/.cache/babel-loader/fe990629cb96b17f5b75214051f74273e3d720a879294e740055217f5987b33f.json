{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mazharkhan/Desktop/chat-app/vibe-chat/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"/Users/mazharkhan/Desktop/chat-app/vibe-chat/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/Users/mazharkhan/Desktop/chat-app/vibe-chat/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{GoogleAuthProvider,signInWithPopup,getAuth}from'firebase/auth';import{initializeApp}from\"firebase/app\";import{getFirestore,collection,addDoc,serverTimestamp,onSnapshot,query,orderBy}from'firebase/firestore';// TODO: Add SDKs for Firebase products that you want to use\n// https://firebase.google.com/docs/web/setup#available-libraries\n// Your web app's Firebase configuration\nvar firebaseConfig={apiKey:\"AIzaSyCdkXtibUpJxzMda8VC5QCLVPG4l4kqlQE\",authDomain:\"chat-app-44f96.firebaseapp.com\",projectId:\"chat-app-44f96\",storageBucket:\"chat-app-44f96.appspot.com\",messagingSenderId:\"713961132173\",appId:\"1:713961132173:web:070545bdefac1f9da5d2c4\"};// Initialize Firebase\n//eslint-disable-next-line \nvar app=initializeApp(firebaseConfig);var db=getFirestore(app);function loginWithGoogle(){return _loginWithGoogle.apply(this,arguments);}function _loginWithGoogle(){_loginWithGoogle=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var provider,auth,_yield$signInWithPopu,user;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;provider=new GoogleAuthProvider();auth=getAuth();_context.next=5;return signInWithPopup(auth,provider);case 5:_yield$signInWithPopu=_context.sent;user=_yield$signInWithPopu.user;return _context.abrupt(\"return\",{uid:user.uid,displayName:user.displayName});case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);if(_context.t0.code!=='auth/cancelled-popup-request'){console.error(_context.t0);}return _context.abrupt(\"return\",null);case 14:case\"end\":return _context.stop();}},_callee,null,[[0,10]]);}));return _loginWithGoogle.apply(this,arguments);}function sendMessage(_x,_x2,_x3){return _sendMessage.apply(this,arguments);}function _sendMessage(){_sendMessage=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(roomId,user,text){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return addDoc(collection(db,'chat-rooms',roomId,'messages'),{uid:user.uid,displayName:user.displayName,text:text.trim(),timestamp:serverTimestamp()});case 3:_context2.next=8;break;case 5:_context2.prev=5;_context2.t0=_context2[\"catch\"](0);console.error(_context2.t0);case 8:case\"end\":return _context2.stop();}},_callee2,null,[[0,5]]);}));return _sendMessage.apply(this,arguments);}function getMessages(roomId,callback){return onSnapshot(query(collection(db,'chat-rooms',roomId,'messages'),orderBy('timestamp','asc')),function(querySnapshot){var messages=querySnapshot.docs.map(function(x){return _objectSpread({id:x.id},x.data());});callback(messages);});}export{loginWithGoogle,sendMessage,getMessages};","map":{"version":3,"names":["GoogleAuthProvider","signInWithPopup","getAuth","initializeApp","getFirestore","collection","addDoc","serverTimestamp","onSnapshot","query","orderBy","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","app","db","loginWithGoogle","_loginWithGoogle","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","provider","auth","_yield$signInWithPopu","user","wrap","_callee$","_context","prev","next","sent","abrupt","uid","displayName","t0","code","console","error","stop","sendMessage","_x","_x2","_x3","_sendMessage","_callee2","roomId","text","_callee2$","_context2","trim","timestamp","getMessages","callback","querySnapshot","messages","docs","map","x","_objectSpread","id","data"],"sources":["/Users/mazharkhan/Desktop/chat-app/vibe-chat/src/services/firebase.js"],"sourcesContent":["\nimport { GoogleAuthProvider, signInWithPopup, getAuth } from 'firebase/auth';\nimport { initializeApp } from \"firebase/app\";\nimport {\n    getFirestore,\n    collection,\n    addDoc,\n    serverTimestamp,\n    onSnapshot,\n    query,\n    orderBy,\n} from 'firebase/firestore';\n\n// TODO: Add SDKs for Firebase products that you want to use\n// https://firebase.google.com/docs/web/setup#available-libraries\n\n// Your web app's Firebase configuration\nconst firebaseConfig = {\n  apiKey: \"AIzaSyCdkXtibUpJxzMda8VC5QCLVPG4l4kqlQE\",\n  authDomain: \"chat-app-44f96.firebaseapp.com\",\n  projectId: \"chat-app-44f96\",\n  storageBucket: \"chat-app-44f96.appspot.com\",\n  messagingSenderId: \"713961132173\",\n  appId: \"1:713961132173:web:070545bdefac1f9da5d2c4\"\n};\n\n// Initialize Firebase\n//eslint-disable-next-line \nconst app = initializeApp(firebaseConfig);\nconst db = getFirestore(app);\n\n\nasync function loginWithGoogle() {\n    try {\n        const provider = new GoogleAuthProvider();\n        const auth = getAuth();\n\n        const { user } = await signInWithPopup(auth, provider);\n\n        return { uid: user.uid, displayName: user.displayName };\n    } catch (error) {\n        if (error.code !== 'auth/cancelled-popup-request') {\n            console.error(error);\n        }\n        return null;\n    }\n}\n\nasync function sendMessage(roomId, user, text) {\n    try {\n        await addDoc(collection(db, 'chat-rooms', roomId, 'messages'), {\n            uid: user.uid,\n            displayName: user.displayName,\n            text: text.trim(),\n            timestamp: serverTimestamp(),\n        });\n    } catch (error) {\n        console.error(error);\n    }\n}\n\nfunction getMessages(roomId, callback) {\n    return onSnapshot(\n        query(\n            collection(db, 'chat-rooms', roomId, 'messages'),\n            orderBy('timestamp', 'asc')\n        ),\n        (querySnapshot) => {\n            const messages = querySnapshot.docs.map((x) => ({\n                id: x.id,\n                ...x.data(),\n            }));\n\n            callback(messages);\n        }\n    );\n}\n\nexport { loginWithGoogle , sendMessage ,getMessages};"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}